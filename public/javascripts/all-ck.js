/*!
 * Bootstrap v3.0.2 by @fat and @mdo
 * Copyright 2013 Twitter, Inc.
 * Licensed under http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built with all the love in the world by @mdo and @fat.
 */function tomorrow(e){var t=new Date(e);t.setDate(t.getDate()+1);return t}function yesturday(e){var t=new Date(e);t.setDate(t.getDate()-1);return t}function sameDay(e,t){return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()?!0:!1}function expandDates(e){var t=_.map(e,function(e){return{date:new Date(e.date),_id:e._id,free:e.free}});allPopulatedDates=_.map(t,function(e){return e.date.toDateString()});var n=new Date,r=new Date;e.length>0&&(r=t[0].date);for(var i=1;i<t.length;i++){t[i].date<n&&(n=t[i].date);t[i].date>r&&(r=t[i].date)}var s=[],o=new Date(n),u=new Date(r);u.setDate(u.getDate()+7);var a=new Date(o.getFullYear(),o.getMonth(),1),f=new Date(a);while(f.getDay()!==1)f=yesturday(f);var l=f,c=365,h=90,p=!1,d=!1;while(c-->0){allPopulatedDates.indexOf(l.toDateString())==-1&&t.push({date:l});!p&&l>u&&(p=!0);l=tomorrow(l);!d&&p&&t.length>h&&l.getDate()===1&&(d=!0);if(d&&l.getDay()===1)break}t=_.sortBy(t,function(e){return e.date});return t}if("undefined"==typeof jQuery)throw new Error("Bootstrap requires jQuery");+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one(e.support.transition.end,function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t()})}(jQuery),+function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){s.trigger("closed.bs.alert").remove()}var r=e(this),i=r.attr("data-target");i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,""));var s=e(i);t&&t.preventDefault(),s.length||(s=r.hasClass("alert")?r:r.parent()),s.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.one(e.support.transition.end,n).emulateTransitionEnd(150):n())};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),"string"==typeof t&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}(jQuery),+function(e){"use strict";var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.is("input")?"val":"html",i=n.data();e+="Text",i.resetText||n.data("resetText",n[r]()),n[r](i[e]||this.options[e]),setTimeout(function(){"loadingText"==e?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons"]'),t=!0;if(e.length){var n=this.$element.find("input");"radio"===n.prop("type")&&(n.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}t&&this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s="object"==typeof n&&n;i||r.data("bs.button",i=new t(this,s)),"toggle"==n?i.toggle():n&&i.setState(n)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle"),t.preventDefault()})}(jQuery),+function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},t.prototype.to=function(t){var n=this,r=this.getActiveIndex();return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid",function(){n.to(t)}):r==t?this.pause().cycle():this.slide(t>r?"next":"prev",e(this.$items[t]))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){return this.sliding?void 0:this.slide("next")},t.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},t.prototype.slide=function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o="next"==t?"left":"right",u="next"==t?"first":"last",f=this;if(!i.length){if(!this.options.wrap)return;i=this.$element.find(".item")[u]()}this.sliding=!0,s&&this.pause();var l=e.Event("slide.bs.carousel",{relatedTarget:i[0],direction:o});if(!i.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(f.$indicators.children()[f.getActiveIndex()]);t&&t.addClass("active")})),e.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(l),l.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),r.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),f.sliding=!1,setTimeout(function(){f.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(l),l.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("bs.carousel"),s=e.extend({},t.DEFAULTS,r.data(),"object"==typeof n&&n),o="string"==typeof n?n:s.slide;i||r.data("bs.carousel",i=new t(this,s)),"number"==typeof n?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n,r=e(this),i=e(r.attr("data-target")||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),r.data()),o=r.attr("data-slide-to");o&&(s.interval=!1),i.carousel(s),(o=r.attr("data-slide-to"))&&i.data("bs.carousel").to(o),t.preventDefault()}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var t=e(this);t.carousel(t.data())})})}(jQuery),+function(e){"use strict";var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=e.Event("show.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide"),r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return e.support.transition?(this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350),void 0):r.call(this)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),"object"==typeof n&&n);i||r.data("bs.collapse",i=new t(this,s)),"string"==typeof n&&i[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var n,r=e(this),i=r.attr("data-target")||t.preventDefault()||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":r.data(),f=r.attr("data-parent"),l=f&&e(f);o&&o.transitioning||(l&&l.find('[data-toggle=collapse][data-parent="'+f+'"]').not(r).addClass("collapsed"),r[s.hasClass("in")?"addClass":"removeClass"]("collapsed")),s.collapse(u)})}(jQuery),+function(e){"use strict";function t(){e(r).remove(),e(i).each(function(t){var r=n(e(this));r.hasClass("open")&&(r.trigger(t=e.Event("hide.bs.dropdown")),t.isDefaultPrevented()||r.removeClass("open").trigger("hidden.bs.dropdown"))})}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var r=".dropdown-backdrop",i="[data-toggle=dropdown]",s=function(t){e(t).on("click.bs.dropdown",this.toggle)};s.prototype.toggle=function(r){var i=e(this);if(!i.is(".disabled, :disabled")){var s=n(i),o=s.hasClass("open");if(t(),!o){if("ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t),s.trigger(r=e.Event("show.bs.dropdown")),r.isDefaultPrevented())return;s.toggleClass("open").trigger("shown.bs.dropdown"),i.focus()}return!1}},s.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var r=e(this);if(t.preventDefault(),t.stopPropagation(),!r.is(".disabled, :disabled")){var s=n(r),o=s.hasClass("open");if(!o||o&&27==t.keyCode)return 27==t.which&&s.find(i).focus(),r.click();var u=e("[role=menu] li:not(.divider):visible a",s);if(u.length){var f=u.index(u.filter(":focus"));38==t.keyCode&&f>0&&f--,40==t.keyCode&&f<u.length-1&&f++,~f||(f=0),u.eq(f).focus()}}}};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),r=n.data("dropdown");r||n.data("dropdown",r=new s(this)),"string"==typeof t&&r[t].call(n)})},e.fn.dropdown.Constructor=s,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",i,s.prototype.toggle).on("keydown.bs.dropdown.data-api",i+", [role=menu]",s.prototype.keydown)}(jQuery),+function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n);s||i.data("bs.modal",s=new t(this,o)),"string"==typeof n?s[n](r):o.show&&s.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".modal",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){e(document.body).removeClass("modal-open")})}(jQuery),+function(e){"use strict";var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);for(var i=this.options.trigger.split(" "),s=i.length;s--;){var o=i[s];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){var u="hover"==o?"mouseenter":"focus",f="hover"==o?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show),void 0):n.show()},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide),void 0):n.hide()},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,f=n[0].offsetHeight;if(s){var l=this.$element.parent(),c=r,h=document.documentElement.scrollTop||document.body.scrollTop,p="body"==this.options.container?window.innerWidth:l.outerWidth(),d="body"==this.options.container?window.innerHeight:l.outerHeight(),v="body"==this.options.container?0:l.offset().left;r="bottom"==r&&o.top+o.height+f-h>d?"top":"top"==r&&o.top-h-f<0?"bottom":"right"==r&&o.right+u>p?"left":"left"==r&&o.left-u<v?"right":r,n.removeClass(c).addClass(r)}var m=this.getCalculatedOffset(r,o,u,f);this.applyPlacement(m,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("in");var a=r[0].offsetWidth,f=r[0].offsetHeight;if("top"==t&&f!=s&&(n=!0,e.top=e.top+s-f),/bottom|top/.test(t)){var l=0;e.left<0&&(l=-2*e.left,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=n.hoverState&&r.detach()}var n=this,r=this.tip(),i=e.Event("hide.bs."+this.type);return this.$element.trigger(i),i.isDefaultPrevented()?void 0:(r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.$element.trigger("hidden.bs."+this.type),this)},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-r,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s="object"==typeof n&&n;i||r.data("bs.tooltip",i=new t(this,s)),"string"==typeof n&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),+function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s="object"==typeof n&&n;i||r.data("bs.popover",i=new t(this,s)),"string"==typeof n&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),+function(e){"use strict";function t(n,r){var i,s=e.proxy(this.process,this);this.$element=e(n).is("body")?e(window):e(n),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",s),this.options=e.extend({},t.DEFAULTS,r),this.selector=(this.options.target||(i=e(n).attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var n=this;this.$body.find(this.selector).map(function(){var r=e(this),i=r.data("target")||r.attr("href"),s=/^#\w/.test(i)&&e(i);return s&&s.length&&[[s[t]().top+(!e.isWindow(n.$scrollElement.get(0))&&n.$scrollElement.scrollTop()),i]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,r=n-this.$scrollElement.height(),i=this.offsets,s=this.targets,o=this.activeTarget;if(t>=r)return o!=(e=s.last()[0])&&this.activate(e);for(e=i.length;e--;)o!=s[e]&&t>=i[e]&&(!i[e+1]||t<=i[e+1])&&this.activate(s[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parents(".active").removeClass("active");var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',r=e(n).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate")};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("bs.scrollspy"),s="object"==typeof n&&n;i||r.data("bs.scrollspy",i=new t(this,s)),"string"==typeof n&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(jQuery),+function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.data("target");if(r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var i=n.find(".active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});if(t.trigger(s),!s.isDefaultPrevented()){var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})}}},t.prototype.activate=function(t,n,r){function i(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var s=n.find("> .active"),o=r&&e.support.transition&&s.hasClass("fade");o?s.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),s.removeClass("in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),"string"==typeof n&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(jQuery),+function(e){"use strict";var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=null,this.checkPosition()};t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,o=s.top,u=s.bottom;"object"!=typeof s&&(u=o=s),"function"==typeof o&&(o=s.top()),"function"==typeof u&&(u=s.bottom());var f=null!=this.unpin&&r+this.unpin<=i.top?!1:null!=u&&i.top+this.$element.height()>=n-u?"bottom":null!=o&&o>=r?"top":!1;this.affixed!==f&&(this.unpin&&this.$element.css("top",""),this.affixed=f,this.unpin="bottom"==f?i.top-r:null,this.$element.removeClass(t.RESET).addClass("affix"+(f?"-"+f:"")),"bottom"==f&&this.$element.offset({top:document.body.offsetHeight-u-this.$element.height()}))}};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s="object"==typeof n&&n;i||r.data("bs.affix",i=new t(this,s)),"string"==typeof n&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(jQuery);_.templateSettings={interpolate:/\<\@\=(.+?)\@\>/gim,evaluate:/\<\@(.+?)\@\>/gim,escape:/\<\@\-(.+?)\@\>/gim};var isTouchDevice="ontouchstart"in window||!!navigator.msMaxTouchPoints;Array.prototype.removeElement=function(e){var t=this.indexOf(e);while(t!==-1){this.splice(t,1);t=this.indexOf(e)}};window.ChoiceModel=Backbone.Model.extend({initialize:function(){var e=window.location.pathname.split("/");this.url="/event/"+e[e.length-1]+"/choice/"},url:"",pretendFree:!1,isFree:function(){if(window.App.currentAttendee!=null){var e=window.App.currentAttendee.get("_id"),t=this.get("free");return _.isUndefined(t)||t.indexOf(e)==-1?!1:!0}return!1},toggleFree:function(){var e=this.get("date"),t=this.get("free");if(window.App.currentAttendee!=null){var n=window.App.currentAttendee.get("_id");if(_.isUndefined(t)||t.indexOf(n)==-1){if(_.isUndefined(t))this.set("free",[n]);else{t.push(n);this.trigger("change")}window.App.wasFree.indexOf(e)!=-1?window.App.wasFree.removeElement(e):window.App.isFree.push(this.get("date"))}else{t.removeElement(n);this.trigger("change");window.App.isFree.indexOf(e)!=-1?window.App.isFree.removeElement(e):window.App.wasFree.push(this.get("date"))}this.save();window.App.updateTellEveryoneLink()}else{if(window.App.isFree.indexOf(e)!=-1){window.App.isFree.removeElement(e);this.pretendFree=!1;this.trigger("change")}else{window.App.isFree.push(this.get("date"));this.pretendFree=!0;this.trigger("change")}$("#register-free-dates").val(window.App.isFree)}}});window.ChoicesModel=Backbone.Collection.extend({model:ChoiceModel});window.CalendarModel=Backbone.Model.extend({initialize:function(){}});window.ChoiceView=Backbone.View.extend({initialize:function(){_.bindAll(this);this.listenTo(this.model,"change",this.modelChanged)},template:_.template($("#choice-template").html()),events:{"click div:first":"dayClicked"},pie:null,className:"date-cell",render:function(){this.$el.html(this.template(this.model.attributes));this.pie=this.$el.find(".pie");this.updateView(!1);return this},modelChanged:function(){this.updateView(!0)},updateView:function(e){var t=$(this.$el).find("div:first");if(t.hasClass("selected")){t.find("div:nth-of-type(2)").toggleClass("free");t.find("div:nth-of-type(2)").toggleClass("unknown")}else{$(".selected").removeClass("selected");t.addClass("selected")}if(this.model.has("free")){var n=this.model.get("free");this.targetDeg=this.calcDegrees(window.App.attendees.length,n.length);if(e)this.animatePie();else{this.pie.attr("data-value",this.targetDeg);this.targetDeg>=180?this.pie.addClass("big"):this.pie.removeClass("big")}(this.model.isFree()||this.model.pretendFree)&&this.$el.find(".unknown").addClass("free").removeClass("unknown")}},animatePie:function(){var e=parseInt(this.pie.attr("data-value")),t=0;e<this.targetDeg&&(t=10);e>this.targetDeg&&(t=-10);if(t!==0){this.pie.attr("data-value",e+t);e+t>=180?this.pie.addClass("big"):this.pie.removeClass("big");_.delay(this.animatePie,10)}},dayClicked:function(e){var t=$(this.$el).find("div:first");if(t.hasClass("selected"))this.model.toggleFree();else{$(".selected").removeClass("selected");t.addClass("selected");var n=t.parents("tr");App.updateSelectedItem(this.model,n)}},calcDegrees:function(e,t){return Math.round(t/e*36)*10}});window.ChoicesView=Backbone.View.extend({initialize:function(){_.bindAll(this);var e=this;this._choiceViews=[];this.collection.each(function(t){e._choiceViews.push(new ChoiceView({model:t,tagName:"td"}))})},el:$(".event-table"),monthTitleTemplate:_.template($("#month-title-template").html()),today:new Date,render:function(){var e=this;$(this.el).empty();var t=null,n=!1,r=!0;_(this._choiceViews).each(function(i){var s=i.model.get("date");if(s.getDay()==1){e.$el.append($("<tr></tr>"));t=e.$el.find("tr:last");rowItemCount=0}if(t!==null){s.getDate()==1&&(t=e.insertMonthTitle(rowItemCount,t,moment(s).format("MMMM")));t.append(i.render().el);rowItemCount++}if(!n&&sameDay(e.today,s)){var o=i.$el.find("div:first"
);o.addClass("today");n=!0}r&&(e.today<s||sameDay(e.today,s)?r=!1:i.$el.find("div:first").addClass("past"))});this.$el.append($("<tr class='selected-row'><td colspan='7' width='7'></td></tr>"));this.$el.find(".today").length>0&&this.$el.find(".today")[0].scrollIntoView(!0);var i=$("body");i.scrollTop(i.scrollTop()-70);return this},insertMonthTitle:function(e,t,n){var r=e,i=0,s=!0,o=0;e>3&&(i=7-e);while(o<7){var u=$(this.monthTitleTemplate({month:n,showTitle:o==i}));if(s){u.removeClass("first-seven").addClass("first");s=!1}moment().format("MMMM")==n&&u.addClass("this-month");t.append(u);o++;if(o==7-e){this.$el.append($("<tr></tr>"));t=this.$el.find("tr:last")}}return t}});window.EventApp=Backbone.View.extend({initialize:function(){_.bindAll(this)},loadBootstrapData:function(e,t,n){this.choices=new ChoicesModel;this.choices.reset(expandDates(e));this.attendees=new Backbone.Collection;this.attendees.reset(t);this.model=new CalendarModel(n);this.currentAttendee=this.attendees.findWhere({me:!0});this.currentAttendeeId=this.currentAttendee!=null?this.currentAttendee.get("_id"):-1;_.isUndefined(this.currentAttendee)&&(this.currentAttendee=null);this.ChoicesView=new ChoicesView({collection:this.choices,attendees:this.attendees});this.ChoicesView.render();var r=window.location.pathname.split("/");this.currentId=r[r.length-1];this.render()},el:$("body"),events:{"click #show-info":"infoClicked","click .title":"infoClicked",click:"eventTableClicked","click #add-attendee-link":"addAttendeeLinkClicked","click #add-attendee-cancel-link":"addAttendeeCancelClicked","keyup #add-attendee-email-input":"addAttendeeInputChanged","keyup #register-attendee-email-input":"registerAttendeeInputChanged"},selectedRowTemplate:_.template($("#selected-row-template").html()),isFree:[],wasFree:[],infoClicked:function(){this.$el.find(".info").slideToggle("fast");this.$el.find("#show-info > span").toggleClass("show-info-rotate")},topNavBarEl:$(".navbar-fixed-top"),scrollStarted:!1,render:function(){var e=this;this.$el.find(".title").html(this.model.get("name"));var t="";_.each(this.attendees.models,function(e){e.get("me")?t="<strong>"+e.get("prettyName")+"</strong>, "+t:t=t+e.get("prettyName")+", "});t=t.slice(0,-2);this.$el.find(".attendees").html(t);if(this.currentAttendee===null){this.$el.find("#add-attendee").hide();$("#register-modal").modal("show");this.registerFooterEl.slideDown("fast")}else this.showWelcome&&$("#welcome-modal").modal("show");this.$el.find("#register-form").attr("action","/event/"+this.currentId+"/add/");_.delay(function(){$(window).on("scrollstart touchmove",function(){if(!this.scrollStarted){this.scrollStarted=!0;e.topNavBarEl.addClass("faded")}});$(window).on("scrollstop",function(){this.scrollStarted=!1;_.delay(function(){e.topNavBarEl.removeClass("faded")},250)})},1e3)},eventTableClicked:function(e){var t=$(e.target);if(t.parents("td.date-cell").length===0&&t.parents(".info-row").length===0&&this.infoRowView!==null){this.infoRowView.removeSelectedRow();$(".selected").removeClass("selected")}},infoRowView:null,updateSelectedItem:function(e,t){this.infoRowView===null?this.infoRowView=new InfoRowView({model:e,el:t}):this.infoRowView.update(e,t)},addAttendeeClicked:function(){this.$el.find("#add-attendee").hide();this.$el.find("#email-group").hide();this.$el.find(".add-attendee-panel").show()},addAttendeeLinkClicked:function(){var e=this;if(!this.isEmailAddressValid(this.$el.find("#add-attendee-email-input").val())){e.$el.find(".add-attendee-message").slideDown("fast");e.$el.find(".add-attendee-message").text("Invalid email address.");return}var t=this.$el.find("#add-attendee-email-input").val(),n=this.$el.find(".add-attendee-panel"),r=this.$el.find(".add-attendee-email-spinner");this.$el.find(".add-attendee-message").hide();this.$el.find(".add-attendee-email-validation").hide();this.$el.find(".add-attendee-message").text("");n.addClass("disabled");r.show();$.post("/event/"+this.currentId+"/add/",{email:t},function(t){e.attendees.add(t);e.render();e.$el.find("#add-attendee-email-input").val("");e.addAttendeeInputChanged()}).fail(function(){e.$el.find(".add-attendee-message").slideDown("fast");e.$el.find(".add-attendee-message").text("Whao! Something didn't quite work there. Reload and try again?!")}).always(function(){e.$el.find(".add-attendee-email-validation").show();n.removeClass("disabled");r.hide()})},addAttendeeCancelClicked:function(){this.$el.find("#add-attendee").show();this.$el.find("#email-group").show();this.$el.find(".add-attendee-panel").hide();this.$el.find("#add-attendee-email-input").val("");this.$el.find(".add-attendee-message").hide();this.$el.find(".add-attendee-message").text("");this.$el.find(".add-attendee-email-validation").removeClass("add-attendee-email-validation-valid")},addAttendeeInputChanged:function(){var e=this.$el.find(".add-attendee-email-validation"),t=this.$el.find(".add-attendee-message");if(this.isEmailAddressValid(this.$el.find("#add-attendee-email-input").val())){e.addClass("add-attendee-email-validation-valid");t.slideUp("fast");t.text("")}else e.removeClass("add-attendee-email-validation-valid")},registerAttendeeInputChanged:function(e){if(e.which!=13){var t=$(".register-attendee-message");t.html("");messages.slideUp("fast")}},isEmailAddressValid:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,n=e.match(t);return!_.isUndefined(n)&&n!==null},changesMadeLinkkeyEl:$(".changes-made-email-link"),updatedFooterEl:$("#updated-footer"),registerFooterEl:$("#register-footer"),titleMailEl:$("#title-mail"),topRowSpacerEl:$("#top-row-spacer"),switchedUpdateAttendeesLink:!1,updateTellEveryoneLink:function(){var e="mailto:"+this.model.get("id")+"@convenely.com?subject=RE:"+encodeURIComponent(" "+this.model.get("name"))+"&body="+encodeURIComponent(this.formatUpdatedDays(this.isFree,this.wasFree));this.changesMadeLinkkeyEl.attr("href",e);if(this.isFree.length>0||this.wasFree.length>0)if(!this.switchedUpdateAttendeesLink){this.updatedFooterEl.show();this.switchedUpdateAttendeesLink=!0;var t=this;_.delay(function(){t.swtichUpdateAttendeesLink()},2e3)}},swtichUpdateAttendeesLink:function(){this.titleMailEl.show();var e=this.$el.find("#changes-made-banner > .fa-envelope-o").offset(),t=this.titleMailEl.find(".fa-envelope-o").offset();this.titleMailEl.hide();var n=e.top-t.top+6,r=e.left-t.left+8,i=this;this.titleMailEl.css({left:r+"px",top:n+"px","-webkit-transform":"scale(0.7,0.7)"});_.delay(function(){i.titleMailEl.show();i.$el.find("#changes-made-banner > .fa-envelope-o").hide();i.updatedFooterEl.slideUp("fast");_.delay(function(){i.titleMailEl.removeAttr("style")},10)},10)},formatUpdatedDays:function(e,t){return e.length>0?t.length>0?"I'm now free on "+this.buildDatesString(e)+" but I'm no longer free on "+this.buildDatesString(t)+".":"I'm now free on "+this.buildDatesString(e)+".":t.length>0?"I'm no longer free on "+this.buildDatesString(t)+".":""},buildDatesString:function(e){var t="";e=e.sort(function(e,t){return e>t});var n=_.map(e,function(e){return moment(e).format("dddd Do MMMM")});n.length>0&&(n.length==1?t+=n[0]:t=t+n.slice(0,-1).join(", ")+" and "+n[n.length-1]);return t},validateEmail:function(){var e=$("#register-attendee-email-input"),t=$(".register-attendee-message");if(e.val()===null||e.val()===""){t.html("Please enter your email address");t.slideDown("fast");return!1}if(!this.isEmailAddressValid(e.val())){t.html("Please enter a valid email address");t.slideDown("fast");return!1}}});
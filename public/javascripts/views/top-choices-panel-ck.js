window.TopChoicesPanel=Backbone.View.extend({initialize:function(){_.bindAll(this);this.render();this.listenTo(this.model,"change",this.modelChanged);this.itemsContainerEl=this.$el.find(".side-info-panel-left-container")},template:_.template($("#top-choices-template").html()),itemTemplate:_.template($("#top-choices-item-template").html()),events:{},render:function(){this.$el.html(this.template());this.$el.hide();$(".event-container").after(this.$el)},oneModel:null,twoModel:null,threeModel:null,modelChanged:function(){var e=this.model.get("one"),t=this.model.get("two"),n=this.model.get("three");if(e===null){this.$el.hide();return}this.$el.show();var r=this.itemsContainerEl.find(".top-choice-one"),i=this.itemsContainerEl.find(".top-choice-two"),s=this.itemsContainerEl.find(".top-choice-three");if(e!==null){if(e!==this.oneModel){e===this.twoModel?i.addClass("top-choice-one").removeClass("top-choice-two"):e===this.threeModel?s.addClass("top-choice-one").removeClass("top-choice-three"):this.createItem(e,"top-choice-one");this.oneModel!==t&&this.oneModel!==n&&this.removeItem(r)}}else this.removeItem(r);if(t!==null){if(t!==this.twoModel){t===this.oneModel?r.addClass("top-choice-two").removeClass("top-choice-one"):t===this.threeModel?s.addClass("top-choice-two").removeClass("top-choice-three"):this.createItem(t,"top-choice-two");this.twoModel!==e&&this.twoModel!==n&&this.removeItem(i)}}else this.removeItem(i);if(n!==null){if(n!==this.threeModel){n===this.oneModel?r.addClass("top-choice-three").removeClass("top-choice-one"):n===this.twoModel?i.addClass("top-choice-three").removeClass("top-choice-two"):this.createItem(n,"top-choice-three");this.threeModel!==e&&this.threeModel!==t&&this.removeItem(s)}}else this.removeItem(s);this.oneModel=e;this.twoModel=t;this.threeModel=n},createItem:function(e,t){var n=$(this.itemTemplate({date:moment(e.get("date")).format("dddd <br/> Do MMMM")}));this.itemsContainerEl.append(n);_.delay(function(){n.addClass(t)},10)},removeItem:function(e){e.addClass("top-choice-hiding");_.delay(function(){e.remove()},500)}});